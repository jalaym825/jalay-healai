import { StreamSfuClient } from '../StreamSfuClient';
import { Dispatcher } from './Dispatcher';
import { CallState } from '../store';
export type SubscriberOpts = {
    sfuClient: StreamSfuClient;
    dispatcher: Dispatcher;
    state: CallState;
    connectionConfig?: RTCConfiguration;
    onUnrecoverableError?: () => void;
    logTag: string;
};
/**
 * A wrapper around the `RTCPeerConnection` that handles the incoming
 * media streams from the SFU.
 *
 * @internal
 */
export declare class Subscriber {
    private readonly logger;
    private pc;
    private sfuClient;
    private state;
    private readonly unregisterOnSubscriberOffer;
    private readonly unregisterOnIceRestart;
    private readonly onUnrecoverableError?;
    private isIceRestarting;
    /**
     * Constructs a new `Subscriber` instance.
     *
     * @param sfuClient the SFU client to use.
     * @param dispatcher the dispatcher to use.
     * @param state the state of the call.
     * @param connectionConfig the connection configuration to use.
     * @param iceRestartDelay the delay in milliseconds to wait before restarting ICE when connection goes to `disconnected` state.
     * @param onUnrecoverableError a callback to call when an unrecoverable error occurs.
     * @param logTag a tag to use for logging.
     */
    constructor({ sfuClient, dispatcher, state, connectionConfig, onUnrecoverableError, logTag, }: SubscriberOpts);
    /**
     * Creates a new `RTCPeerConnection` instance with the given configuration.
     *
     * @param connectionConfig the connection configuration to use.
     */
    private createPeerConnection;
    /**
     * Closes the `RTCPeerConnection` and unsubscribes from the dispatcher.
     */
    close: () => void;
    /**
     * Detaches the event handlers from the `RTCPeerConnection`.
     * This is useful when we want to replace the `RTCPeerConnection`
     * instance with a new one (in case of migration).
     */
    detachEventHandlers: () => void;
    /**
     * Returns the result of the `RTCPeerConnection.getStats()` method
     * @param selector
     * @returns
     */
    getStats: (selector?: MediaStreamTrack | null | undefined) => Promise<RTCStatsReport>;
    /**
     * Sets the SFU client to use.
     *
     * @param sfuClient the SFU client to use.
     */
    setSfuClient: (sfuClient: StreamSfuClient) => void;
    /**
     * Restarts the ICE connection and renegotiates with the SFU.
     */
    restartIce: () => Promise<void>;
    private handleOnTrack;
    private onIceCandidate;
    private negotiate;
    private onIceConnectionStateChange;
    private onIceGatheringStateChange;
    private onIceCandidateError;
}
